[["session8.html", "Session 8 Bringing Everything Together. Part II 8.1 Learning Objectives 8.2 Continuing with the exercise 10 and two-way ANOVA 8.3 Exercise 11", " Session 8 Bringing Everything Together. Part II 8.1 Learning Objectives We will learn how to carry out a two-way mixed anova and produce useful descriptives and plots. 8.2 Continuing with the exercise 10 and two-way ANOVA Our dataframe should be all ready now. You might want to save it to a datafile. We will be going through a number of steps to check ANOVA assumptions and follow-up with any necessary post-hoc analysis. As we do that we will also be generating some graphs which will give us the opportunity to discuss ggplot2 and an extension of it called ggpubr. Our main package for the anova will be the rstatix package. First, lets check that you completed exercise 10. library(tidyverse) stroop &lt;- read_csv(&quot;stroopy stroop.csv&quot;) stroop &lt;- stroop %&gt;% mutate(RT = stroop_resp.rt*1000, group = case_when( participant &lt; 2000 ~ &quot;control&quot;, participant &gt;= 2000 ~ &quot;gambling&quot;), salience = case_when( str_sub(Image,1,1) == &#39;G&#39;~&quot;Gambling&quot;, str_sub(Image,1,1) == &#39;N&#39;~&quot;Neutral&quot;)) %&gt;% filter(stroop_resp.rt &gt; 0.3 &amp; stroop_resp.rt &lt; 3.0 &amp; stroop_trials.thisTrialN &gt; 2) stroop2 &lt;- stroop %&gt;% group_by(participant, group, salience) %&gt;% summarise(RT = mean(RT)) %&gt;% ungroup() We will now start working on our two-way analysis of variance. First we will load the necessary libraries and convert our IVs into factors. library(tidyverse) library(ggpubr) library(rstatix) ## make sure you have run the code above ## converting group and salience to factors stroop2 &lt;- stroop2 %&gt;% mutate(group = as.factor(group), salience = as.factor(salience)) ## let&#39;s inspect our RT visually ggboxplot(stroop2, x = &quot;salience&quot;, y = &quot;RT&quot;, color = &quot;group&quot;) ##perhaps it would be more meaningful to also see boxplots per group ## we will also assign it to a variable so we can use it later box1 &lt;- ggboxplot(stroop2, x = &quot;group&quot;, y = &quot;RT&quot;, color = &quot;salience&quot;) We will now proceed with checks for outliers and anova assumptions. As this is a 2x2 some of the following checks are not meaningful but we will include them for reference. ## check for outliers stroop2 %&gt;% group_by(salience, group) %&gt;% identify_outliers(RT) ## Normality check stroop2 %&gt;% group_by(salience, group) %&gt;% shapiro_test(RT) ## you may also want to check this visually ## using a QQplot ggqqplot(stroop2, &quot;RT&quot;, ggtheme = theme_bw()) + facet_grid(group ~ salience) ## Homogeneity of variance assumption stroop2 %&gt;% group_by(salience) %&gt;% levene_test(RT ~ group) ## the assumption of sphericity will be checked during anova Assuming everything is in order we can proceed to carrying out the anova. ## anova time # first describe the model anova.model &lt;- anova_test( data = stroop2, dv = RT, wid = participant, ## this is our participant id variable between = group, within = salience ) # then get the anova table get_anova_table(anova.model) As we can see we have a significant interaction as well as a main effect. We have to follow up the interaction. ## First, We will need to regroup our data simple.model &lt;- stroop2 %&gt;% group_by(group) %&gt;% anova_test(dv = RT, wid = participant, within = salience) %&gt;% get_anova_table() %&gt;% adjust_pvalue(method = &quot;bonferroni&quot;) simple.model ## or we could run pairwise comparisons pair.model &lt;- stroop2 %&gt;% group_by(salience) %&gt;% pairwise_t_test(RT ~ group, p.adjust.method = &quot;bonferroni&quot;) pair.model ## it would also be useful to report means and sd stroop2 %&gt;% group_by(salience, group) %&gt;% get_summary_stats(RT, type = &quot;mean_sd&quot;) From here we can also generate plots if we want to as we already all the necessary stats figures. pair.model &lt;- pair.model %&gt;% add_xy_position(x = &quot;salience&quot;) box1 + stat_pvalue_manual(pair.model, tip.length = 0, hide.ns = TRUE) + labs( subtitle = get_test_label(anova.model, detailed = TRUE), caption = get_pwc_label(pair.model) ) ## or with a barchart box2 &lt;- ggbarplot(stroop2, x = &quot;group&quot;, y = &quot;RT&quot;, width = 0.5, color = &quot;salience&quot;, fill = &quot;salience&quot;, position = position_dodge(0.5), add = &quot;mean_se&quot;, add.params = list(color = &quot;black&quot;), label = TRUE, lab.vjust = -2, lab.nb.digits = 2) box2 ## Let us also save our final stroop2 dataframe write_csv(stroop2, &quot;stroopfinal.csv&quot;) As mentioned earlier ggpubr is a package that calls ggplot2. It is really versatile and can cover all our needs in terms of analysis and publications. However, ggplot2 offers many more features that you can try to explore on your own. 8.3 Exercise 11 Now that you are familiar with the two-way anova you should attempt the three-way anova based on the data that we prepared in the previous session. "]]
